# Empty String Analysis

This document identifies areas in the codebase where empty strings could potentially be set as attributes or field values. The analysis was performed after updating `transaction.name` in `receiver.go` to prevent empty strings.

## Summary

The codebase uses a helper function `attribute.PutStr()` that checks for empty strings before setting attributes. However, there are many places where `attributes.PutStr()` is called directly (bypassing the helper), which could potentially set empty string values.

## Findings

| File                                                    | Line    | Code Snippet                                                                                                       | Field/Attribute                                              | Current Behavior              | Risk Level | Notes                                |
|---------------------------------------------------------|---------|--------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|-------------------------------|------------|--------------------------------------|
| **receiver.go**                                         |
| receiver.go                                             | 337     | `m.SetName(sample.GetName())`                                                                                      | Metric name                                                  | No empty check                | Medium     | Metric name could be empty           |
| receiver.go                                             | 490     | `attribute.PutStr(attr, "transaction.name", event.Transaction.Name)`                                               | transaction.name                                             | ✅ Uses helper (checks empty)  | Low        | Already protected                    |
| receiver.go                                             | 491     | `attribute.PutStr(attr, "transaction.type", event.Transaction.Type)`                                               | transaction.type                                             | ✅ Uses helper (checks empty)  | Low        | Already protected                    |
| receiver.go                                             | 494     | `attr.PutStr("span.type", event.Span.Type)`                                                                        | span.type                                                    | ❌ Direct call, no empty check | High       | Could set empty string               |
| receiver.go                                             | 495     | `attr.PutStr("span.subtype", event.Span.Subtype)`                                                                  | span.subtype                                                 | ❌ Direct call, no empty check | High       | Could set empty string               |
| receiver.go                                             | 518     | `l.Body().SetStr(event.Error.Log.Message)`                                                                         | Log body (error)                                             | ❌ No empty check              | Medium     | Could set empty message              |
| receiver.go                                             | 531     | `l.Body().SetStr(event.Message)`                                                                                   | Log body                                                     | ❌ No empty check              | Medium     | Could set empty message              |
| receiver.go                                             | 574     | `s.SetName(transaction.GetName())`                                                                                 | Span name (transaction)                                      | ❌ No empty check              | High       | **Fixed by user**                    |
| receiver.go                                             | 594     | `s.SetName(span.GetName())`                                                                                        | Span name (span)                                             | ❌ No empty check              | High       | Similar to line 574                  |
| **internal/mappers/intakeV2ToDerivedFields.go**         |
| intakeV2ToDerivedFields.go                              | 37      | `attributes.PutStr(elasticattr.ProcessorEvent, "transaction")`                                                     | processor.event                                              | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToDerivedFields.go                              | 49      | `attribute.PutStr(attributes, elasticattr.TransactionName, event.Transaction.Name)`                                | transaction.name                                             | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 50      | `attribute.PutStr(attributes, elasticattr.TransactionType, event.Transaction.Type)`                                | transaction.type                                             | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 51      | `attribute.PutStr(attributes, elasticattr.TransactionResult, event.Transaction.Result)`                            | transaction.result                                           | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 59      | `attribute.PutStr(attributes, elasticattr.TransactionID, event.Transaction.Id)`                                    | transaction.id                                               | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 63      | `attributes.PutStr(elasticattr.ServiceTargetType, event.Service.Target.Type)`                                      | service.target.type                                          | ❌ Direct call, no empty check | Medium     | Has nil check but no empty check     |
| intakeV2ToDerivedFields.go                              | 64      | `attributes.PutStr(elasticattr.ServiceTargetName, event.Service.Target.Name)`                                      | service.target.name                                          | ❌ Direct call, no empty check | Medium     | Has nil check but no empty check     |
| intakeV2ToDerivedFields.go                              | 70      | `attributes.PutStr(elasticattr.ProcessorEvent, "span")`                                                            | processor.event                                              | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToDerivedFields.go                              | 79      | `attributes.PutStr("span.id", event.Span.Id)`                                                                      | span.id                                                      | ❌ Direct call, no empty check | Medium     | Could set empty string               |
| intakeV2ToDerivedFields.go                              | 81      | `attribute.PutStr(attributes, elasticattr.SpanName, event.Span.Name)`                                              | span.name                                                    | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 82      | `attribute.PutStr(attributes, elasticattr.SpanType, event.Span.Type)`                                              | span.type                                                    | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 83      | `attribute.PutStr(attributes, elasticattr.SpanSubtype, event.Span.Subtype)`                                        | span.subtype                                                 | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 84      | `attribute.PutStr(attributes, "span.action", event.Span.Action)`                                                   | span.action                                                  | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 91      | `attribute.PutStr(attributes, elasticattr.SpanDestinationServiceResource, event.Span.DestinationService.Resource)` | span.destination.service.resource                            | ✅ Uses helper                 | Low        | Already protected                    |
| intakeV2ToDerivedFields.go                              | 98      | `attributes.PutStr(elasticattr.AgentName, event.Agent.Name)`                                                       | agent.name                                                   | ❌ Direct call, no empty check | Medium     | Has nil check but no empty check     |
| intakeV2ToDerivedFields.go                              | 99      | `attributes.PutStr(elasticattr.AgentVersion, event.Agent.Version)`                                                 | agent.version                                                | ❌ Direct call, no empty check | Medium     | Has nil check but no empty check     |
| intakeV2ToDerivedFields.go                              | 105     | `attributes.PutStr(attr.ServiceLanguageName, event.Service.Language.Name)`                                         | service.language.name                                        | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 108     | `attributes.PutStr(attr.ServiceLanguageVersion, event.Service.Language.Version)`                                   | service.language.version                                     | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 116     | `attributes.PutStr(elasticattr.ProcessorEvent, "metric")`                                                          | processor.event                                              | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToDerivedFields.go                              | 125-129 | `attributes.PutStr(elasticattr.EventOutcome, ...)`                                                                 | event.outcome                                                | ✅ Constant values             | Low        | Safe - constants                     |
| intakeV2ToDerivedFields.go                              | 135     | `attributes.PutStr(elasticattr.ProcessorEvent, "error")`                                                           | processor.event                                              | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToDerivedFields.go                              | 144     | `attributes.PutStr(elasticattr.ErrorID, event.Error.Id)`                                                           | error.id                                                     | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 147     | `attributes.PutStr(elasticattr.ParentID, event.ParentId)`                                                          | parent.id                                                    | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 151     | `attributes.PutStr("error.type", event.Error.Type)`                                                                | error.type                                                   | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 154     | `attributes.PutStr("message", event.Error.Message)`                                                                | message                                                      | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 156     | `attributes.PutStr(elasticattr.ErrorGroupingKey, event.Error.GroupingKey)`                                         | error.grouping_key                                           | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToDerivedFields.go                              | 160     | `attributes.PutStr("error.culprit", event.Error.Culprit)`                                                          | error.culprit                                                | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 165     | `attributes.PutStr("exception.type", event.Error.Exception.Type)`                                                  | exception.type                                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 168     | `attributes.PutStr("exception.message", event.Error.Exception.Message)`                                            | exception.message                                            | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 186     | `attributes.PutStr("exception.stacktrace", str)`                                                                   | exception.stacktrace                                         | ❌ Direct call, no empty check | Medium     | Could be empty if no frames          |
| intakeV2ToDerivedFields.go                              | 190     | `attributes.PutStr("error.exception.module", event.Error.Exception.Module)`                                        | error.exception.module                                       | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToDerivedFields.go                              | 196     | `attributes.PutStr("error.exception.code", event.Error.Exception.Code)`                                            | error.exception.code                                         | ✅ Has empty check             | Low        | Protected by if statement            |
| **internal/mappers/intakeV2ToElasticSpecificFields.go** |
| intakeV2ToElasticSpecificFields.go                      | 60      | `attributesMap.PutStr(attr.SpanDBLink, event.Span.Db.Link)`                                                        | span.db.link                                                 | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 67      | `attributesMap.PutStr(attr.SpanDBUserName, event.Span.Db.UserName)`                                                | span.db.user_name                                            | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 76      | `attributesMap.PutStr(attr.SpanCompositeCompressionStrategy, compressionStrategy)`                                 | span.composite.compression_strategy                          | ✅ Has ok check                | Low        | Protected by map lookup              |
| intakeV2ToElasticSpecificFields.go                      | 85      | `attributesMap.PutStr(attr.SpanDestinationServiceName, event.Span.DestinationService.Name)`                        | span.destination.service.name                                | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToElasticSpecificFields.go                      | 86      | `attributesMap.PutStr(attr.SpanDestinationServiceType, event.Span.DestinationService.Type)`                        | span.destination.service.type                                | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToElasticSpecificFields.go                      | 101     | `attributesMap.PutStr(attr.HTTPVersion, http.Version)`                                                             | http.version                                                 | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 116     | `attributesMap.PutStr(attr.HTTPRequestID, http.Request.Id)`                                                        | http.request.id                                              | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 119     | `attributesMap.PutStr(attr.HTTPRequestReferrer, http.Request.Referrer)`                                            | http.request.referrer                                        | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 186     | `attributesMap.PutStr(fmt.Sprintf("%s.%s", prefix, attr.MessageRoutingKey), m.RoutingKey)`                         | message.routing_key                                          | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 189     | `attributesMap.PutStr(fmt.Sprintf("%s.%s", prefix, attr.MessageBody), m.Body)`                                     | message.body                                                 | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 225     | `frameMap.PutStr(attr.SpanStacktraceFrameFilename, frame.Filename)`                                                | span.stacktrace.frame.filename                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 228     | `frameMap.PutStr(attr.SpanStacktraceFrameClassname, frame.Classname)`                                              | span.stacktrace.frame.classname                              | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 231     | `frameMap.PutStr(attr.SpanStacktraceFrameLineContext, frame.ContextLine)`                                          | span.stacktrace.frame.line_context                           | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 234     | `frameMap.PutStr(attr.SpanStacktraceFrameModule, frame.Module)`                                                    | span.stacktrace.frame.module                                 | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 237     | `frameMap.PutStr(attr.SpanStacktraceFrameFunction, frame.Function)`                                                | span.stacktrace.frame.function                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 240     | `frameMap.PutStr(attr.SpanStacktraceFrameAbsPath, frame.AbsPath)`                                                  | span.stacktrace.frame.abs_path                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 292     | `dest.SetStr(v.StringValue)`                                                                                       | Various (from structpb)                                      | ❌ No empty check              | Medium     | Could set empty string from protobuf |
| intakeV2ToElasticSpecificFields.go                      | 365     | `attributesMap.PutStr(attr.SessionID, event.Session.Id)`                                                           | session.id                                                   | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 399     | `statMap.PutStr(attr.TransactionDroppedSpansStatsDestinationServiceResource, stat.DestinationServiceResource)`     | transaction.dropped_spans_stats.destination_service.resource | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 402     | `statMap.PutStr(attr.TransactionDroppedSpansStatsOutcome, stat.Outcome)`                                           | transaction.dropped_spans_stats.outcome                      | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 445-473 | Multiple `attributesMap.PutStr(...)` calls                                                                         | Various cloud/service fields                                 | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToElasticSpecificFields.go                      | 479     | `attributesMap.PutStr(attr.FaaSTriggerRequestID, event.Faas.TriggerRequestId)`                                     | faas.trigger.request_id                                      | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 482     | `attributesMap.PutStr(attr.FaaSExecution, event.Faas.Execution)`                                                   | faas.execution                                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 488     | `attributesMap.PutStr(attr.AgentEphemeralID, event.Agent.EphemeralId)`                                             | agent.ephemeral_id                                           | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 491     | `attributesMap.PutStr(attr.AgentActivationMethod, event.Agent.ActivationMethod)`                                   | agent.activation_method                                      | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 498-520 | Multiple `attributesMap.PutStr(...)` calls                                                                         | Various service fields                                       | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToElasticSpecificFields.go                      | 528     | `attributesMap.PutStr(attr.HostOSPlatform, event.Host.Os.Platform)`                                                | host.os.platform                                             | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 537     | `attributesMap.PutStr(attr.SourceNatIP, ip.String())`                                                              | source.nat.ip                                                | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 544     | `attributesMap.PutStr(attr.UserDomain, event.User.Domain)`                                                         | user.domain                                                  | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 551     | `attributesMap.PutStr(attr.DestinationIP, ip.String())`                                                            | destination.ip                                               | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 570     | `attributesMap.PutStr(attrKey, labelValue.Value)`                                                                  | labels.*                                                     | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 599     | `attributesMap.PutStr(attr.LogLogger, event.Log.Logger)`                                                           | log.logger                                                   | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 604     | `attributesMap.PutStr(attr.LogOriginFunction, event.Log.Origin.FunctionName)`                                      | log.origin.function_name                                     | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 611     | `attributesMap.PutStr(attr.LogOriginFileName, event.Log.Origin.File.Name)`                                         | log.origin.file.name                                         | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 619-628 | Multiple `attributesMap.PutStr(...)` calls                                                                         | Various event fields                                         | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToElasticSpecificFields.go                      | 633     | `attributesMap.PutStr(attr.EventKind, "event")`                                                                    | event.kind                                                   | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToElasticSpecificFields.go                      | 640     | `attributesMap.PutStr(attr.ProcessThreadName, event.Process.Thread.Name)`                                          | process.thread.name                                          | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToElasticSpecificFields.go                      | 650-659 | Multiple `attributesMap.PutStr(...)` calls                                                                         | Various error log fields                                     | ✅ Has empty checks            | Low        | All protected by if statements       |
| **internal/mappers/intakeV2ToSemConv.go**               |
| intakeV2ToSemConv.go                                    | 36      | `attributes.PutStr(string(semconv.ServiceNameKey), event.Service.Name)`                                            | service.name                                                 | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 39      | `attributes.PutStr(string(semconv.ServiceVersionKey), event.Service.Version)`                                      | service.version                                              | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 42      | `attributes.PutStr(string(semconv.TelemetrySDKLanguageKey), ...)`                                                  | telemetry.sdk.language                                       | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 44      | `attributes.PutStr(string(semconv.TelemetrySDKNameKey), "ElasticAPM")`                                             | telemetry.sdk.name                                           | ✅ Constant value              | Low        | Safe - constant                      |
| intakeV2ToSemConv.go                                    | 47-48   | `attributes.PutStr(...)` calls                                                                                     | deployment.environment                                       | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 51      | `attributes.PutStr(string(semconv.ServiceInstanceIDKey), event.Service.Node.Name)`                                 | service.instance.id                                          | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 56-68   | Multiple `attributes.PutStr(...)` calls                                                                            | Various host fields                                          | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToSemConv.go                                    | 77      | `attributes.PutStr(string(semconv.UserAgentOriginalKey), event.UserAgent.Original)`                                | user_agent.original                                          | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 106     | `attributes.PutStr(string(semconv.MessagingDestinationNameKey), event.Transaction.Message.QueueName)`              | messaging.destination.name                                   | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 120     | `attributes.PutStr(string(semconv.DBSystemKey), event.Span.Db.Type)`                                               | db.system                                                    | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 121     | `attributes.PutStr(string(semconv.DBNamespaceKey), event.Span.Db.Instance)`                                        | db.namespace                                                 | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 122     | `attributes.PutStr(string(semconv.DBQueryTextKey), event.Span.Db.Statement)`                                       | db.query.text                                                | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 127     | `attributes.PutStr(string(semconv.MessagingSystemKey), event.Span.Subtype)`                                        | messaging.system                                             | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 129     | `attributes.PutStr(string(semconv.MessagingOperationNameKey), event.Span.Action)`                                  | messaging.operation.name                                     | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 132     | `attributes.PutStr(string(semconv.MessagingDestinationNameKey), event.Span.Message.QueueName)`                     | messaging.destination.name                                   | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 138     | `attributes.PutStr(string(semconv.DestinationAddressKey), event.Destination.Address)`                              | destination.address                                          | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 157-270 | Multiple `attributes.PutStr(...)` calls                                                                            | Various cloud/container/user/network fields                  | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToSemConv.go                                    | 294     | `attributes.PutStr(key, ipAddr.String())`                                                                          | client.address / source.address                              | ✅ Has empty check             | Low        | Protected by if statement            |
| intakeV2ToSemConv.go                                    | 302-311 | Multiple `attributes.PutStr(...)` calls                                                                            | Various FaaS fields                                          | ✅ Has empty checks            | Low        | All protected by if statements       |
| intakeV2ToSemConv.go                                    | 322     | `attributes.PutStr(string(semconv.HTTPRequestMethodKey), event.Http.Request.Method)`                               | http.request.method                                          | ❌ Direct call, no empty check | High       | Could set empty string               |
| intakeV2ToSemConv.go                                    | 342-360 | Multiple `attributes.PutStr(...)` calls                                                                            | Various URL fields                                           | ✅ Has empty checks            | Low        | All protected by if statements       |

## High Priority Issues

The following locations have **high risk** of setting empty strings and should be prioritized for fixes:

1. **receiver.go:494** - `span.type` - Direct PutStr call
2. **receiver.go:495** - `span.subtype` - Direct PutStr call  
3. **receiver.go:594** - Span name (span) - SetName call without empty check
4. **intakeV2ToDerivedFields.go:156** - `error.grouping_key` - Direct PutStr call
5. **intakeV2ToElasticSpecificFields.go:85-86** - `span.destination.service.name` and `span.destination.service.type` - Direct PutStr calls
6. **intakeV2ToSemConv.go:106** - `messaging.destination.name` (transaction) - Direct PutStr call
7. **intakeV2ToSemConv.go:120-122** - `db.system`, `db.namespace`, `db.query.text` - Direct PutStr calls
8. **intakeV2ToSemConv.go:127** - `messaging.system` - Direct PutStr call
9. **intakeV2ToSemConv.go:129** - `messaging.operation.name` - Direct PutStr call
10. **intakeV2ToSemConv.go:322** - `http.request.method` - Direct PutStr call

## Medium Priority Issues

1. **receiver.go:337** - Metric name - SetName call
2. **receiver.go:518, 531** - Log body messages - SetStr calls
3. **intakeV2ToDerivedFields.go:186** - `exception.stacktrace` - Could be empty if no frames
4. **intakeV2ToElasticSpecificFields.go:292** - `insertValue` function - Could set empty strings from protobuf values

## Recommendations

1. **Use the helper function**: Replace direct `attributes.PutStr()` calls with `attribute.PutStr()` helper function which checks for empty strings.

2. **Add empty checks for SetName**: Similar to the fix for `transaction.name`, add empty string checks before calling `SetName()` for spans and metrics.

3. **Add empty checks for log bodies**: Consider adding empty string checks before setting log body messages.

4. **Review protobuf value handling**: The `insertValue` function in `intakeV2ToElasticSpecificFields.go` should check for empty strings before setting values.

5. **Consistent pattern**: Establish a consistent pattern - either always use the helper function or always add explicit empty checks before setting string attributes.

## Helper Function Reference

The `attribute.PutStr()` helper function (defined in `internal/attribute/attribute.go`) already handles empty string checks:

```go
func PutStr(attributes pcommon.Map, key, value string) {
	if value != "" {
		attributes.PutStr(key, value)
	}
}
```

This helper should be used consistently throughout the codebase to prevent empty strings from being set as attributes.
